package com.xinput.wechat;import com.xinput.bleach.util.BuilderUtils;import com.xinput.bleach.util.JsonUtils;import com.xinput.bleach.util.Logs;import com.xinput.bleach.util.ObjectId;import com.xinput.wechat.config.WechatConfig;import com.xinput.wechat.exception.WechatPayException;import com.xinput.wechat.request.OrderQueryRequest;import com.xinput.wechat.request.UnifiedOrderRequest;import com.xinput.wechat.response.OrderQueryResponse;import com.xinput.wechat.response.UnifiedOrderResponse;import com.xinput.wechat.result.OrderSignature;import org.junit.jupiter.api.Test;import org.slf4j.Logger;/** * 用例2【扫码-正常】订单金额3.02元（含0.01元充值代金券，0.02元免充值代金券），用户支付成功 * 【必选】支付成功用例集 * <p> * 用例名 * 【扫码-正常】订单金额3.02元（含0.01元充值代金券，0.02元免充值代金券），用户支付成功 * * @author <a href="mailto:xinput.xx@gmail.com">xinput</a> * @date 2020-09-29 17:45 */public class Case_02 {    private static final Logger logger = Logs.get();    @Test    public void unifiedOrder() throws WechatPayException {        UnifiedOrderRequest request = BuilderUtils.of(UnifiedOrderRequest::new)                // 商品名称                .with(UnifiedOrderRequest::setBody, "嘉云升-阿米洛机械键盘")                // 获取客户端的ip地址                .with(UnifiedOrderRequest::setSpbill_create_ip, "192.168.10.13")                // 商户订单号,自己的订单ID                .with(UnifiedOrderRequest::setOut_trade_no, ObjectId.stringId())                // 支付金额                .with(UnifiedOrderRequest::setTotal_fee, 302)                // 支付成功后的回调地址                .with(UnifiedOrderRequest::setNotify_url, WechatConfig.getWechatNotifyUnifiedOrderUrl())                // 支付方式                .with(UnifiedOrderRequest::setTrade_type, "JSAPI")                .with(UnifiedOrderRequest::setDevice_info, "青轴机械键盘")                .build();        UnifiedOrderResponse response = WechatPayApi.unifiedOrder(request);        logger.info("UnifiedOrderResponse : {}", JsonUtils.toJsonString(response, true));        // 再次签名        OrderSignature orderSignature = new OrderSignature(response);        logger.info("orderSignature : " + JsonUtils.toJsonString(orderSignature, true));    }    @Test    public void orderQuery() throws WechatPayException {        String transaction_id = "4602805686220200929181330132677";        String out_trade_no = "5f7308c66b5adf9727f6b8f9";        OrderQueryRequest request = new OrderQueryRequest();        // 参数二选一        request.setTransaction_id(transaction_id);        request.setOut_trade_no(out_trade_no);        OrderQueryResponse response = WechatPayApi.queryOrder(request);        logger.info(JsonUtils.toJsonString(response, true));    }    @Test    public void orderQuery01() {        String transaction_id = "4602805686220200929181330132677";        String out_trade_no = "5f7308c66b5adf9727f6b8f9";        try {            OrderQueryResponse response = WechatPayApi.queryOrderByTransactionId(transaction_id);            logger.info(JsonUtils.toJsonString(response, true));        } catch (Exception e) {            e.printStackTrace();        }    }    @Test    public void orderQuery02() {        String out_trade_no = "5f7308c66b5adf9727f6b8f9";        try {            OrderQueryResponse response = WechatPayApi.queryOrderByOutTradeNo(out_trade_no);            logger.info(JsonUtils.toJsonString(response, true));        } catch (Exception e) {            e.printStackTrace();        }    }}